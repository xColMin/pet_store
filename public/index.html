<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />

    <link rel="icon" href="/images/paw.png" type=“image/x-icon” />
    <!-- CSS only -->
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
      integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" type="text/css" href="css/custom.css" />
    <title>VIPets</title>
  </head>

  <!--NAVBAR-->

  <body>
    <div class="jumbotron" id="nav-jumbo">
      <nav
        class="navbar navbar-expand-lg navbar-light"
        style="background-color: #cee7fa"
      >
        <a class="navbar-brand" href="index.html">
          <img src="images/VIPets.png" width="50" height="50" />
        </a>

        <div class="navbar-collapse collapse w-100 order-3 dual-collapse2">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item" id="login-anchor">
              <!--<a class="nav-item nav-link" href="login.html">Login</a>-->
            </li>
            <li class="nav-item">
              <a class="nav-item nav-link" href="signIn.html">Sing In</a>
            </li>
            <li class="nav-item">
              <button class="d-none btn btn-outline-success my-2 my-sm-0">
                Admin
              </button>
            </li>
          </ul>
        </div>

        <div class="navbar-nav" id="navbar-main">
          <a class="nav-item nav-link" href="catalog.html">Catalog</a>
        </div>
      </nav>
    </div>

    <script>
      const navbar = document.getElementById("navbar-main");

      isAdmin();

      async function isAdmin() {
        const response = await fetch("/is_admin");
        const data = await response.json();

        var size = Object.keys(data).length - 1;

        for (let i = 0; i <= size; i++) {
          if (data[i]["_id"] == "IGLAwEzJmo9dqnf8") {
            if (data[i]["userStatus"] == 1) {
              const addPet = document.createElement("a");
              addPet.href = "addPet.html";
              addPet.textContent = `Add\xa0Pet`;
              addPet.className = "nav-item nav-link";
              navbar.append(addPet);
              const adminPanel = document.createElement("a");
              adminPanel.href = "adminPanel.html";
              adminPanel.textContent = `Admin\xa0Panel`;
              adminPanel.className = "nav-item nav-link";
              navbar.append(adminPanel);
            } else {
              break;
            }
          }
        }
      }
    </script>

    <script>
      const loginAnchor = document.getElementById("login-anchor");

      isLogIn();

      async function isLogIn() {
        const response = await fetch("/is_login");
        const data = await response.json();

        var size = Object.keys(data).length - 1;

        let login = false;
        let admin = false;

        for (let i = 0; i <= size; i++) {
          if (data[i]["userStatus"] == 1) {
            login = true;
            if (data[i]["_id"] == "IGLAwEzJmo9dqnf8") {
              admin = true;
            }
            break;
          }
        }

        if (!login) {
          const loginOption = document.createElement("a");
          loginOption.href = "login.html";
          loginOption.textContent = `Login`;
          loginOption.className = "nav-item nav-link";
          loginAnchor.append(loginOption);
        } else {
          const logOutOption = document.createElement("a");
          logOutOption.textContent = `Logout`;
          logOutOption.className = "nav-item nav-link";
          logOutOption.onclick = function () {
            logOut();
          };
          logOutOption.href = "#";
          loginAnchor.append(logOutOption);
          if (!admin) {
            const myPurcahses = document.createElement("a");
            myPurcahses.textContent = `My\xa0VIPs`;
            myPurcahses.className = "nav-item nav-link";
            myPurcahses.href = "my_vips.html";
            navbar.append(myPurcahses);
          }
        }
      }

      async function logOut() {
        console.log("Log Out");
        const options = {
          method: "POST",
          headers: { "Content-Type": "application/json" },
        };
        const response = await fetch("/user_api/logout_user", options);
      }
    </script>

    <!--END NAVBAR-->

    <div class="jumbotron" id="vip-daily">
      <h1>VIPs of the Day!</h1>
    </div>

    <div class="jumbotron" id="carousel-jumbo">
      <script
        src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"
      ></script>
      <script
        src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"
      ></script>
      <script
        src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"
      ></script>

      <div
        id="carouselExampleIndicators"
        class="carousel slide"
        data-ride="carousel"
      >
        <ol class="carousel-indicators">
          <li
            data-target="#carouselExampleIndicators"
            data-slide-to="0"
            class="active"
          ></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
          <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner">
          <div class="carousel-item active">
            <img class="d-block w-100" alt="First slide" id="first-slide" />
            <div class="carousel-caption d-none d-md-block"></div>
          </div>
          <div class="carousel-item">
            <img class="d-block w-100" alt="Second slide" id="second-slide" />
          </div>
          <div class="carousel-item">
            <img class="d-block w-100" alt="Third slide" id="third-slide" />
          </div>
        </div>
        <a
          class="carousel-control-prev"
          href="#carouselExampleIndicators"
          role="button"
          data-slide="prev"
        >
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a
          class="carousel-control-next"
          href="#carouselExampleIndicators"
          role="button"
          data-slide="next"
        >
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>
    </div>

    <script>
      async function getPics() {
        const response = await fetch("/pet_api");
        const data = await response.json();

        function getRandomArbitrary(max) {
          return Math.floor(Math.random() * max);
        }

        let n = getRandomArbitrary(data.length);

        const img1 = document.getElementById("first-slide");
        img1.class = "d-block w-100 center-block";
        img1.width = "221";
        img1.height = "228";
        img1.src = data[n].photoUrls[0].data;
        data.shift();

        const img2 = document.getElementById("second-slide");
        img2.class = "d-block w-100";
        img2.width = "221";
        img2.height = "228";
        img2.src = data[n].photoUrls[0].data;
        data.shift();

        const img3 = document.getElementById("third-slide");
        img3.class = "d-block w-100";
        img3.width = "221";
        img3.height = "228";
        img3.src = data[n].photoUrls[0].data;
      }
      getPics();
    </script>

    <div class="jumbotron" id="about-jumbo">
      <p>
        Very Important Pets is an all-volunteer, non-profit, animal welfare
        organization dedicated to the rescue and placement of stray, neglected
        and abused animals. All VIPets is completely funded through fundraising
        efforts and public donations. All of our pets are cared for by foster
        homes and receive complete medical care, which includes worming,
        vaccinations, spaying/neutering and microchipping prior to their
        adoption. The fees included in this site represent the cost of the
        process of adoption.
      </p>
    </div>

    <script src="pets.js"></script>
    <script src="login.js"></script>
  </body>
</html>
